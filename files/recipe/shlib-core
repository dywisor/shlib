DENY_INHERIT

# $SHLIB_CALL_APPLETS should be set before running this recipe
#
if [ -z "${SHLIB_CALL_APPLETS+SET}" ]; then
   # use default applets
   SHLIB_CALL_APPLETS="\
charwise dir_empty dir_not_empty dodir external_ip get_yn host_alive \
sleeploop str_lstrip str_rstrip str_strip str_trim"
fi

SET_DEFAULTS
[ -z "${D-}" ] || INTO "/${D}"

# big lib
MAKELIB_SHLIB

# install shlib-call-minimal that simply runs functions provided by shlib
LINK_SHARED shlib-call-minimal _shlib-call-minimal

# ... and link applets, if any
if [ -n "${SHLIB_CALL_APPLETS:+SET}" ]; then
   SYMSTORM _shlib-call-minimal ${SHLIB_CALL_APPLETS}
fi

# install "big" shlib-call script (user-targeted shlib-call script)
#
LINK_SHARED shlib-call

STANDALONE fs/get_user_tmpdir get_user_tmpdir

# chmod multicall
LINK_SHARED lib/chmod _shlib_chmod
SYMSTORM _shlib_chmod {-,+}{r,w,x}

# remount multicall
LINK_SHARED lib/remount _shlib_remount
SYMSTORM _shlib_remount {rootfs,boot,efi,usr}-r{o,w}
